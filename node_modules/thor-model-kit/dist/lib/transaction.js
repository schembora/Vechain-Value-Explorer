"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const types_1 = require("./types");
const crypto_1 = require("./crypto");
const rlp = require('rlp');
/**
 * Transaction class defines VeChainThor's multi-clause transaction.
 */
class Transaction {
    /**
     * construct a transaction object with given body
     * @param body
     */
    constructor(body) {
        validateBody(body);
        this.body = body;
    }
    /** returns hash for signing */
    get signingHash() {
        let data = rlp.encode(this.rlpList);
        return crypto_1.blake2b256(data);
    }
    /**
     * returns transaction ID
     * empty ID returned if something wrong (e.g. invalid signature)
     */
    get id() {
        try {
            return crypto_1.blake2b256(this.signingHash.bytes, this.signer.bytes);
        }
        catch (_a) {
            return new types_1.Bytes32(Buffer.alloc(0));
        }
    }
    /** returns signer */
    get signer() {
        if (!this.signature)
            throw new Error('signature missing');
        let pubKey = crypto_1.Secp256k1.recover(this.signingHash, this.signature);
        return crypto_1.Secp256k1.deriveAddress(pubKey);
    }
    /** returns intrinsic gas it takes */
    get intrinsicGas() {
        const txGas = 5000;
        const clauseGas = 16000;
        const clauseGasContractCreation = 48000;
        if (this.body.clauses.length === 0)
            return txGas + clauseGas;
        return this.body.clauses.reduce((sum, c) => {
            if (c.to)
                sum += clauseGas;
            else
                sum += clauseGasContractCreation;
            sum += dataGas(c.data);
            return sum;
        }, txGas);
    }
    /**
     * returns absolute gas price according to base gas price
     * @param baseGasPrice
     */
    gasPrice(baseGasPrice) {
        let bgp = baseGasPrice.toBigNumber();
        let extra = bgp
            .multipliedBy(this.body.gasPriceCoef)
            .dividedToIntegerBy(0xff);
        return types_1.BigInt.from(bgp.plus(extra));
    }
    /** encode into Buffer */
    encode() {
        let list = this.rlpList;
        if (this.signature)
            list.push(this.signature);
        return rlp.encode(list);
    }
    /** decode from Buffer to transaction */
    static decode(raw) {
        let list = decodeList(rlp.decode(raw), 10);
        let tx = new Transaction({
            chainTag: decodeNumber(list[0]),
            blockRef: decodeBlockRef(list[1]),
            expiration: decodeNumber(list[2]),
            clauses: decodeClauses(list[3]),
            gasPriceCoef: decodeNumber(list[4]),
            gas: decodeBigInt(list[5]),
            dependsOn: decodeBytes32OrNull(list[6]),
            nonce: decodeBigInt(list[7]),
            reserved: decodeList(list[8])
        });
        tx.signature = decodeBuffer(list[9]);
        return tx;
    }
    get rlpList() {
        let body = this.body;
        return [
            body.chainTag,
            new types_1.BigInt(body.blockRef).bytes,
            body.expiration,
            body.clauses.map(clause => [
                clause.to ? clause.to.bytes : '',
                clause.value.bytes,
                clause.data,
            ]),
            body.gasPriceCoef,
            body.gas.bytes,
            body.dependsOn ? body.dependsOn.bytes : '',
            body.nonce.bytes,
            body.reserved,
        ];
    }
}
exports.Transaction = Transaction;
function decodeClauses(data) {
    return decodeList(data).map(v => {
        let clauseData = decodeList(v, 3);
        return {
            to: decodeAddressOrNull(clauseData[0]),
            value: new types_1.BigInt(decodeBuffer(clauseData[1])),
            data: decodeBuffer(clauseData[2])
        };
    });
}
function validateBody(body) {
    mustUintN(body.chainTag, 8, 'chainTag: must be uint8');
    mustUintN(body.expiration, 32, 'expiration: must be uint32');
    mustUintN(body.gasPriceCoef, 8, 'gasPriceCoef: must be uint8');
    mustUintN(body.gas, 64, 'gas: must be uint64');
    mustUintN(body.nonce, 64, 'nonce: must be uint64');
    if (body.blockRef.length != 8)
        throw new Error('blockRef: must be 8 bytes');
}
function mustUintN(num, bits, msg) {
    if (typeof num === 'number') {
        if (!Number.isInteger(num) || num < 0 || num >= Math.pow(2, bits))
            throw new Error(msg);
    }
    else {
        if (num.bytes.length * 8 > bits)
            throw new Error(msg);
    }
}
function decodeBigInt(data) {
    let buf = decodeBuffer(data);
    let bi = new types_1.BigInt(buf);
    if (bi.bytes.length != buf.length)
        throw new Error('non-canonical integer (leading zero bytes) for integer');
    return bi;
}
function decodeNumber(data) {
    let bi = decodeBigInt(data);
    if (bi.bytes.length * 8 > 53)
        throw new Error('unable to safely decode to number');
    return bi.toBigNumber().toNumber();
}
function decodeBuffer(data) {
    if (!Buffer.isBuffer(data))
        throw new Error('buffer expected');
    return data;
}
function decodeBytes32OrNull(data) {
    let buf = decodeBuffer(data);
    if (buf.length == 0)
        return null;
    if (buf.length != 32)
        throw new Error('bytes32 expected');
    return new types_1.Bytes32(buf);
}
function decodeList(data, elemCount) {
    if (!Array.isArray(data))
        throw new Error('list expected');
    if (elemCount !== undefined) {
        if (data.length !== elemCount)
            throw new Error('list element count incorrect');
    }
    return data;
}
function decodeAddressOrNull(data) {
    let buf = decodeBuffer(data);
    if (buf.length == 0)
        return null;
    if (buf.length != 20)
        throw new Error('address expected');
    return new types_1.Address(buf);
}
function decodeBlockRef(data) {
    let bi = decodeBigInt(data);
    if (bi.bytes.length > 8)
        throw new Error('blockRef: too long');
    let buf = Buffer.alloc(8);
    bi.bytes.copy(buf, buf.length - bi.bytes.length);
    return buf;
}
function dataGas(data) {
    const zgas = 4;
    const nzgas = 68;
    return data.reduce((sum, cur) => {
        if (cur)
            return sum + nzgas;
        return sum + zgas;
    }, 0);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNhY3Rpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbGliL3RyYW5zYWN0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQWtEO0FBQ2xELHFDQUFnRDtBQUNoRCxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUE7QUFFMUI7O0dBRUc7QUFDSDtJQU9JOzs7T0FHRztJQUNILFlBQVksSUFBc0I7UUFDOUIsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFBO1FBQ2xCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFBO0lBQ3BCLENBQUM7SUFFRCwrQkFBK0I7SUFDL0IsSUFBSSxXQUFXO1FBQ1gsSUFBSSxJQUFJLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDbkMsT0FBTyxtQkFBVSxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQzNCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxJQUFJLEVBQUU7UUFDRixJQUFJO1lBQ0EsT0FBTyxtQkFBVSxDQUNiLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FDcEIsQ0FBQTtTQUNKO1FBQUMsV0FBSztZQUNILE9BQU8sSUFBSSxlQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQ3RDO0lBQ0wsQ0FBQztJQUVELHFCQUFxQjtJQUNyQixJQUFJLE1BQU07UUFDTixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVM7WUFDZixNQUFNLElBQUksS0FBSyxDQUFDLG1CQUFtQixDQUFDLENBQUE7UUFDeEMsSUFBSSxNQUFNLEdBQUcsa0JBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDaEUsT0FBTyxrQkFBUyxDQUFDLGFBQWEsQ0FBQyxNQUFN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